<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

  <title>El Quijote xd</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"
    integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>

<body>
  <button id="order"><a href="order.html"><i class="fa-duotone fa-solid fa-list-ol"></i></a></button>


   <!-- Slider main container -->
   <div class="swiper">
    <!-- Additional required wrapper -->
    <div class="swiper-wrapper">
      <!-- Slide 1 -->
      <div class="swiper-slide" data-category="group1">
        <div class="content" data-content="five">

          <h2 id="categories">Entrantes</h2>
          <video id="slider" autoplay muted loop playsinline>
            <source src="sample.mp4" type="video/mp4">
          </video>
        </div>
        <div class="dish-info" id="dish1">
          <button id="add" data-dish-name="Spaghetti a la carbonara" onclick="toggleOrder(this, 'Spaghetti a la carbonara', 'Cosas verdes 500g', 'sample.png')">
            <i class="fa-solid fa-circle-plus"></i>
          </button>
          <h3>Spaghetti a la carbonara</h3>
          <p>Cosas verdes 500 g</p>
          <p>22.50€</p>
          <button id="verMas1" onclick="toggleAllergens('allergens1','verMas1','verMenos1')">Ver más
            <i class="fa-duotone fa-solid fa-angle-down"></i>
          </button>
          <div class="allergens" id="allergens1" style="display: none;">
            <p>Alergenos:</p>
            <p>Gluten, Lactosa</p>
          </div>
          <button id="verMenos1" onclick="toggleAllergens('allergens1', 'verMas1', 'verMenos1')"
            style="display:none;">Ver menos
            <i class="fa-sharp-duotone fa-solid fa-angle-up"></i>
          </button>

        </div>
      </div>
      <!-- Slide 2 -->
      <div class="swiper-slide" data-category="group2">
        <h2 id="categories">Pastas</h2>
        <video id="slider" autoplay muted loop playsinline>
          <source src="macarrones1.mp4" type="video/mp4">
        </video>
        <div class="dish-info" id="dish2">
          <button id="add" data-dish-name="Macarrones con carne picada y judías" onclick="toggleOrder(this, 'Macarrones con carne picada y judías', '500 g de carne picada y judías 9.50€', 'macarrones1foto.png')"><i
              class="fa-solid fa-circle-plus"></i></button>

          <h3>Macarrones con carne picada y judías</h3>
          <p>500 g de carne picada y judías 9.50€</p>
          <button id="verMas2" onclick="toggleAllergens('allergens2','verMas2','verMenos2')">Ver más</button>
          <div class="allergens" id="allergens2" style="display: none;">
            <p>Alergenos:</p>
            <p>Gluten</p>
          </div>
          <button id="verMenos2" onclick="toggleAllergens('allergens2', 'verMas2', 'verMenos2')"
            style="display:none;">Ver menos ⮟</button>
        </div>
      </div>
      <!-- Slide 3 -->

      <div class="swiper-slide" data-category="group2">
        <video id="slider" autoplay muted loop playsinline>
          <source src="macarrones2.mp4" type="video/mp4">
        </video>

        <div class="dish-info" id="dish3">
          <button id="add" data-dish-name="Rigatoni con tomate" onclick="toggleOrder(this, 'Rigatoni con tomate', '8.50€\nPasta con salsa del chef', 'macarrones2foto.png')"><i
              class="fa-solid fa-circle-plus"></i></button>

          <h3>Rigatoni con tomate</h3>
          <p>Rigatoni con tomate', '8.50€\nPasta con salsa del chef</p>
          <button id="verMas3" onclick="toggleAllergens('allergens3','verMas3','verMenos3')">Ver más</button>
          <div class="allergens" id="allergens3" style="display: none;">
            <p>Alergenos:</p>
            <p>Perejil...etc</p>
          </div>
          <button id="verMenos3" onclick="toggleAllergens('allergens3', 'verMas3', 'verMenos3')"
            style="display:none;">Ver menos ⮟</button>
        </div>
      </div>

      <div class="swiper-slide" data-category="group2">
        <video id="slider" autoplay muted loop playsinline>
          <source src="macarrones3.mp4" type="video/mp4">
        </video>

        <div class="dish-info" id="dish4">
          <button id="add" data-dish-name="Macarrones con bacon" onclick="toggleOrder(this, 'Macarrones con bacon', '8.50€', 'macarrones3foto.png')"><i
              class="fa-solid fa-circle-plus"></i></button>

          <h3>Macarrones con bacon</h3>
          <p>8.50€</p>
          <button id="verMas3" onclick="toggleAllergens('allergens3','verMas3','verMenos3')">Ver más</button>
          <div class="allergens" id="allergens3" style="display: none;">
            <p>Alergenos:</p>
            <p>Bacon...etc</p>
          </div>
          <button id="verMenos3" onclick="toggleAllergens('allergens3', 'verMas3', 'verMenos3')"
            style="display:none;">Ver menos ⮟</button>
        </div>
      </div>

      
      <div class="swiper-slide" data-category="group3">
        <video id="slider" autoplay muted loop playsinline>
          <source src="fish1.mp4" type="video/mp4">
        </video>

        <div class="dish-info" id="dish5">
          <button id="add" data-dish-name="Dorada a la plancha" onclick="toggleOrder(this, 'Dorada a la plancha', '10.50€', 'fish1foto.png')"><i
              class="fa-solid fa-circle-plus"></i></button>

          <h3>Dorada a la plancha</h3>
          <p>10.50€</p>
          <button id="verMas3" onclick="toggleAllergens('allergens3','verMas3','verMenos3')">Ver más</button>
          <div class="allergens" id="allergens3" style="display: none;">
            <p>Alergenos:</p>
            <p>Dorada...etc</p>
          </div>
          <button id="verMenos3" onclick="toggleAllergens('allergens3', 'verMas3', 'verMenos3')"
            style="display:none;">Ver menos ⮟</button>
        </div>
      </div>

      <div class="swiper-slide" data-category="group3">
        <video id="slider" autoplay muted loop playsinline>
          <source src="fish2.mp4" type="video/mp4">
        </video>

        <div class="dish-info" id="dish6">
          <button id="add" data-dish-name="Trucha con picadillo" onclick="toggleOrder(this, 'Trucha con picadillo', '15.50€', 'fish2foto.png')"><i
              class="fa-solid fa-circle-plus"></i></button>

          <h3>Trucha con picadillo</h3>
          <p>15.50€</p>
          <button id="verMas3" onclick="toggleAllergens('allergens3','verMas3','verMenos3')">Ver más</button>
          <div class="allergens" id="allergens3" style="display: none;">
            <p>Alergenos:</p>
            <p>Trucha...etc</p>
          </div>
          <button id="verMenos3" onclick="toggleAllergens('allergens3', 'verMas3', 'verMenos3')"
            style="display:none;">Ver menos ⮟</button>
        </div>
      </div>

      <div class="swiper-slide" data-category="group3">
        <video id="slider" autoplay muted loop playsinline>
          <source src="fish3.mp4" type="video/mp4">
        </video>

        <div class="dish-info" id="dish7">
          <button id="add" data-dish-name="Pescado a la parrilla" onclick="toggleOrder(this, 'Pescado a la parrilla', '13.50€', 'fish3foto.png')"><i
              class="fa-solid fa-circle-plus"></i></button>

          <h3>Pescado a la parrilla</h3>
          <p>13.50€</p>
          <button id="verMas3" onclick="toggleAllergens('allergens3','verMas3','verMenos3')">Ver más</button>
          <div class="allergens" id="allergens3" style="display: none;">
            <p>Alergenos:</p>
            <p>Pescado...etc</p>
          </div>
          <button id="verMenos3" onclick="toggleAllergens('allergens3', 'verMas3', 'verMenos3')"
            style="display:none;">Ver menos ⮟</button>
        </div>
      </div>

    </div>
    <!-- If we need pagination -->
    <div class="swiper-pagination"></div>

    <!-- If we need scrollbar 
    <div class="swiper-scrollbar"></div>
    -->
  </div>

  <div class="container">

    <button class="nav-arrow prev" id="btn-scroll-left" onclick="scrollList(-1)"><i
        class="fa-sharp fa-solid fa-arrow-left"></i></button>

    <div class="horizontal-scroll">

      <ul class="navigation">
        <li onclick="filterSlides('group1')"><img src="thumb1.png"></li>
        <li onclick="filterSlides('group2')"><img src="thumb5.png"></li>
        <li onclick="filterSlides('group3')"><img src="thumb6.png"></li>
        <li onclick="filterSlides('group1')"><img src="thumb3.png"></li>
      </ul>
    </div>

    <button class="nav-arrow next" id="btn-scroll-right" onclick="scrollList(1)"><i
        class="fa-sharp fa-solid fa-arrow-right"></i></button>

  </div>

  <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
  <script>
    const swiper = new Swiper('.swiper', {
      direction: 'vertical',
      speed: 200,
      slidesPerView: 1,
      spaceBetween: 0,

      pagination: {
        el: '.swiper-pagination',
        clickable: true,
      },
    });
    

    function filterSlides(category) {
      // Ocultar todas las diapositivas
      const slides = document.querySelectorAll('.swiper-slide');
      slides.forEach(slide => {
        slide.classList.add('hidden');
      });

      // Mostrar solo las diapositivas que coinciden con la categoría seleccionada
      const filteredSlides = document.querySelectorAll(`.swiper-slide[data-category="${category}"]`);
      filteredSlides.forEach(slide => {
        slide.classList.remove('hidden');
      });

        // Guardar la categoría seleccionada en localStorage
        localStorage.setItem('lastCategory', category);

      // Reiniciar Swiper para que se ajuste a las diapositivas visibles
      swiper.update();
    }

        // Función para guardar la diapositiva actual
        function saveCurrentSlide(category, slideIndex) {
        localStorage.setItem('lastCategory', category);
        localStorage.setItem('lastSlideIndex', slideIndex);
    }
        // Ejecuta la función de filtro cuando la página carga para mostrar solo 'group1'
        window.onload = () => {
        const lastCategory = localStorage.getItem('lastCategory') || 'group1'; // Obtener la última categoría o 'group1' por defecto
        const lastSlideIndex = localStorage.getItem('lastSlideIndex') || 0; // Obtener el último índice o 0 por defecto

        filterSlides(lastCategory); // Filtrar por la categoría guardada

        // Después de filtrar, ir a la diapositiva específica
        swiper.slideTo(lastSlideIndex);
    };
    swiper.on('slideChange', () => {
        const currentSlide = swiper.realIndex; // Obtener el índice actual
        const currentCategory = localStorage.getItem('lastCategory'); // Obtener la categoría actual
        saveCurrentSlide(currentCategory, currentSlide); // Guardar la categoría y el índice
    });

  </script>
  <script>
    function toggleAllergens(allergensId, viewMoreId, viewLessId) {
      const allergensDiv = document.getElementById(allergensId);
      const viewMore = document.getElementById(viewMoreId);
      const viewLess = document.getElementById(viewLessId);

      if (allergensDiv.style.display === 'none') {
        allergensDiv.style.display = 'block';
        viewMore.style.display = 'none';
        viewLess.style.display = 'inline-block';
      } else {
        allergensDiv.style.display = 'none';
        viewMore.style.display = 'inline-block';
        viewLess.style.display = 'none';
      }
    }

  </script>

  <script>
    let scrollAmount = 0;
    const scrollStep = 120; // Ajusta este valor para que se desplace un elemento a la vez

    function scrollList(direction) {
      const list = document.querySelector('.navigation');
      const listWidth = list.scrollWidth;
      const containerWidth = document.querySelector('.horizontal-scroll').clientWidth;

      if (direction === 1) {
        // Desplazar hacia la derecha
        scrollAmount += scrollStep;
        if (scrollAmount > listWidth - containerWidth) {
          scrollAmount = listWidth - containerWidth; // No permite sobrepasar el final
        }
      } else {
        // Desplazar hacia la izquierda
        scrollAmount -= scrollStep;
        if (scrollAmount < 0) {
          scrollAmount = 0; // No permite sobrepasar el inicio
        }
      }

      list.style.transform = `translateX(-${scrollAmount}px)`;
    }

  </script>

  <script>
    // Función que revisa el carrito en localStorage y actualiza los íconos de los botones cuando la página se carga.
    document.addEventListener('DOMContentLoaded', () => {
      // Obtener el carrito de localStorage (o crear uno si no existe)
      let cart = JSON.parse(localStorage.getItem('cart')) || [];

      // Recorremos todos los botones "add" en la página
      document.querySelectorAll('button#add').forEach(button => {
        const dishName = button.getAttribute('data-dish-name'); // Usamos un atributo data para identificar el plato

        // Verificamos si el plato ya está en el carrito
        let dishInCart = cart.find(item => item.name === dishName);
        if (dishInCart) {
          // Si está en el carrito, mostramos el icono de check
          button.innerHTML = '<i class="fa-solid fa-check"></i>';
        } else {
          // Si no está en el carrito, mostramos el icono de agregar
          button.innerHTML = '<i class="fa-solid fa-circle-plus"></i>';
        }
      });
    });

    // Función para agregar platos al carrito usando localStorage
    function toggleOrder(button, dishName, description, imageUrl) { // no funciona decirle al chat
    const item = { name: dishName, description: description, imageUrl: imageUrl };

      // Obtener el carrito de localStorage (o crear uno si no existe)
      let cart = JSON.parse(localStorage.getItem('cart')) || [];

      // Buscar si el plato ya está en el carrito
      let dishIndex = cart.findIndex(item => item.name === dishName);

      if (dishIndex !== -1) {
        // Si ya está en el carrito, lo quitamos
        cart.splice(dishIndex, 1);
        button.innerHTML = '<i class="fa-solid fa-circle-plus"></i>';

      } else {
        // Si no está en el carrito, lo agregamos
        cart.push({ name: dishName, description: description, imageUrl:imageUrl, quantity: 1 });
        button.innerHTML = '<i class="fa-solid fa-check"></i>';

      }

      // Guardar de nuevo el carrito actualizado en localStorage
      localStorage.setItem('cart', JSON.stringify(cart));

    }
  </script>


</body>

</html>